#2.
v <- tapply(dat$trans_num,dat$Time,sum)
diff.v<-c()
for(i in 1:length(v)-1){
diff.v[i] <- v[i+1]-v[i]
}
Q3 <- summary(diff.v)[5]
Q1 <- summary(diff.v)[2]
IQR <- Q3-Q1
I <- c(Q1-1.5*IQR,Q3+1.5*IQR)
which(v<I[1]|v>I[2])
which(diff.v<I[1]|diff.v>I[2])
plot(v,type="l",xlab="time",ylab="",main="")
plot(v,type="l",xlab="time",ylab="amount of transacted bitcoin",main="")
diff.v
View(dat)
block <- as.factor(dat$Height)
block
level(block)
levels(block)
block <- level(as.factor(dat$Height))
tapply(dat$block_date, dat$Height, mean)
date.dat <- data.frame(block = level(as.factor(dat$Height)), date = level(dat$block_date), hour=tapply(dat$block_hour,dat$Height,mean), minute=tapply(dat$block_minute,dat$Height,mean), second=tapply(dat$block_second,dat$Height,mean))
date.dat <- data.frame(block = levels(as.factor(dat$Height)), date = levels(dat$block_date), hour=tapply(dat$block_hour,dat$Height,mean), minute=tapply(dat$block_minute,dat$Height,mean), second=tapply(dat$block_second,dat$Height,mean))
levels(as.factor(dat$Height))
length(levels(as.factor(dat$Height)))
length(levels(dat$block_date))
tapply(dat$block_minute,dat$Height,mean)
length(tapply(dat$block_minute,dat$Height,mean))
length(levels(as.factor(dat$Height)))
date.dat <- data.frame(block = levels(as.factor(dat$Height)), hour=tapply(dat$block_hour,dat$Height,mean), minute=tapply(dat$block_minute,dat$Height,mean), second=tapply(dat$block_second,dat$Height,mean))
View(date.dat)
which(levels(as.factor(dat$Height)))
levels(as.factor(dat$Height))
date.dat <- data.frame(block = levels(as.factor(dat$Height)), hour=tapply(dat$block_hour,dat$Height,mean), minute=tapply(dat$block_minute,dat$Height,mean), second=tapply(dat$block_second,dat$Height,mean))
index_repeated_block<-c()
for(i in 2:dim(dat)[1]){
if(dat$Height[i-1]!=dat$Height[i]){
index_repeated_block[i]<-i
}
}
index_repeated_block
if(dat$Height[i-1]!=dat$Height[i]){
index_repeated_block[i]<-i
}else{
index_repeated_block[i]<-0
}
index_repeated_block<-c()
for(i in 2:dim(dat)[1]){
if(dat$Height[i-1]!=dat$Height[i]){
index_repeated_block[i]<-i
}else{
index_repeated_block[i]<-0
}
}
index_repeated_block
index_repeated_block[-which(index_repeated_block=0)]
index_repeated_block[-which(index_repeated_block==0)]
index_repeated_block[-which(index_repeated_block==0|index_repeated_block=='NA')]
index_repeated_block[-which(index_repeated_block==0|index_repeated_block==NA)]
index_repeated_block[-which(index_repeated_block==0|is.na(index_repeated_block))]
for(i in 2:dim(dat)[1]){
if(dat$Height[i-1]!=dat$Height[i]|i==2){
index_repeated_block[i]<-i
}else{
index_repeated_block[i]<-0
}
}
index_repeated_block[-which(index_repeated_block==0|is.na(index_repeated_block))]
length(levels(as.facotr(dat$Height)))
length(levels(as.factor(dat$Height)))
length(index_repeated_block[-which(index_repeated_block==0|is.na(index_repeated_block))])
length(levels(as.factor(dat$Height)))
index_repeated_block <- index_repeated_block[-which(index_repeated_block==0|is.na(index_repeated_block))]
dat$
date.dat <- data.frame(block = levels(as.factor(dat$Height)), date=dat$block_date[index_repeated_block], hour=tapply(dat$block_hour,dat$Height,mean), minute=tapply(dat$block_minute,dat$Height,mean), second=tapply(dat$block_second,dat$Height,mean))
dat$block_date[index_repeated_block]
length(levels(as.factor(dat$Height)))
length(tapply(dat$block_second,dat$Height,mean))
dat$
date.dat <- data.frame(block = levels(as.factor(dat$Height)), date=dat$block_date[index_repeated_block], hour=tapply(dat$block_hour,dat$Height,mean), minute=tapply(dat$block_minute,dat$Height,mean), second=tapply(dat$block_second,dat$Height,mean))
date.dat <- data.frame(block = levels(as.factor(dat$Height)), date=dat$block_date[index_repeated_block], hour=tapply(dat$block_hour,dat$Height,mean), minute=tapply(dat$block_minute,dat$Height,mean), second=tapply(dat$block_second,dat$Height,mean))
date.dat
index_steeps
#2.
v <- tapply(dat$trans_num,dat$Time,sum)
diff.v<-c()
for(i in 1:length(v)-1){
diff.v[i] <- v[i+1]-v[i]
}
Q3 <- summary(diff.v)[5]
Q1 <- summary(diff.v)[2]
IQR <- Q3-Q1
I <- c(Q1-1.5*IQR,Q3+1.5*IQR)
index_steeps <- which(diff.v<I[1]|diff.v>I[2])
index_steeps
date.dat
date.dat$date[2]-date.dat$date[1]
as.Date(date.dat$date[2], format="%m/%d/%Y")-as.Date(date.dat$date[1], format="%m/%d/%Y")
as.Date(date.dat$date[3], format="%m/%d/%Y")-as.Date(date.dat$date[2], format="%m/%d/%Y")
for (i in 1:dim(date.dat)[1]){
day <- as.Date(date.dat$date[], format="%m/%d/%Y")-as.Date(date.dat$date[2], format="%m/%d/%Y")
}
for (i in 1:dim(date.dat)[1]-1){
day[i] <- as.Date(date.dat$date[i+1], format="%m/%d/%Y")-as.Date(date.dat$date[i], format="%m/%d/%Y")
}
day
diff.day<-c()
diff.hour<-c()
diff.min<-c()
diff.sec<-c()
for (i in 1:dim(date.dat)[1]-1){
diff.day[i] <- as.Date(date.dat$date[i+1], format="%m/%d/%Y")-as.Date(date.dat$date[i], format="%m/%d/%Y")
}
for (i in 1:dim(date.dat)[1]-1){
diff.hour[i] <- date.dat$hour[i+1]-date.dat$hour[i]
}
for (i in 1:dim(date.dat)[1]-1){
diff.min[i] <- date.dat$minute[i+1]-date.dat$minute[i]
}
for (i in 1:dim(date.dat)[1]-1){
diff.sec[i] <- date.dat$second[i+1]-date.dat$second[i]
}
diff.hour
diff.im
diff.sec
diff.day
diff.hour
if(diff.sec[i]<0){
diff.min[i] <- diff.min[i]-1
diff.sec[i] <- diff.sec[i]+60
if(diff.min[i]<0){
diff.hour[i] <- diff.hour[i]-1
diff.min[i] <- diff.hour[i]+60
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}else{
diff.hour[i] <- diff.hour[i]
diff.min[i] <- diff.hour[i]
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}
}  else {
diff.min[i] <- diff.min[i]
diff.sec[i] <- diff.sec[i]
if(diff.min[i]<0){
diff.hour[i] <- diff.hour[i]-1
diff.min[i] <- diff.hour[i]+60
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}else{
diff.hour[i] <- diff.hour[i]
diff.min[i] <- diff.hour[i]
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}
}
diff.sec
diff.day<-c()
diff.hour<-c()
diff.min<-c()
diff.sec<-c()
for (i in 1:dim(date.dat)[1]-1){
diff.day[i] <- as.Date(date.dat$date[i+1], format="%m/%d/%Y")-as.Date(date.dat$date[i], format="%m/%d/%Y")
}
for (i in 1:dim(date.dat)[1]-1){
diff.hour[i] <- date.dat$hour[i+1]-date.dat$hour[i]
}
for (i in 1:dim(date.dat)[1]-1){
diff.min[i] <- date.dat$minute[i+1]-date.dat$minute[i]
}
for (i in 1:dim(date.dat)[1]-1){
diff.sec[i] <- date.dat$second[i+1]-date.dat$second[i]
}
for(i in 1:length(diff.day)){
if(diff.sec[i]<0){
diff.min[i] <- diff.min[i]-1
diff.sec[i] <- diff.sec[i]+60
if(diff.min[i]<0){
diff.hour[i] <- diff.hour[i]-1
diff.min[i] <- diff.hour[i]+60
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}else{
diff.hour[i] <- diff.hour[i]
diff.min[i] <- diff.hour[i]
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}
}  else {
diff.min[i] <- diff.min[i]
diff.sec[i] <- diff.sec[i]
if(diff.min[i]<0){
diff.hour[i] <- diff.hour[i]-1
diff.min[i] <- diff.hour[i]+60
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}else{
diff.hour[i] <- diff.hour[i]
diff.min[i] <- diff.hour[i]
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}
}
}
diff.day
diff.hour
diff.min
diff.sec
index_repeated_block<-c()
for(i in 2:dim(dat)[1]){
if(dat$Height[i-1]!=dat$Height[i]|i==2){
index_repeated_block[i]<-i
}else{
index_repeated_block[i]<-0
}
}
index_repeated_block <- index_repeated_block[-which(index_repeated_block==0|is.na(index_repeated_block))]
date.dat <- data.frame(block = levels(as.factor(dat$Height)), date=dat$block_date[index_repeated_block], hour=tapply(dat$block_hour,dat$Height,mean), minute=tapply(dat$block_minute,dat$Height,mean), second=tapply(dat$block_second,dat$Height,mean))
diff.day<-c()
diff.hour<-c()
diff.min<-c()
diff.sec<-c()
for (i in 1:dim(date.dat)[1]-1){
diff.day[i] <- as.Date(date.dat$date[i+1], format="%m/%d/%Y")-as.Date(date.dat$date[i], format="%m/%d/%Y")
}
for (i in 1:dim(date.dat)[1]-1){
diff.hour[i] <- date.dat$hour[i+1]-date.dat$hour[i]
}
for (i in 1:dim(date.dat)[1]-1){
diff.min[i] <- date.dat$minute[i+1]-date.dat$minute[i]
}
for (i in 1:dim(date.dat)[1]-1){
diff.sec[i] <- date.dat$second[i+1]-date.dat$second[i]
}
for(i in 1:length(diff.day)){
if(diff.sec[i]<0){
diff.min[i] <- diff.min[i]-1
diff.sec[i] <- diff.sec[i]+60
if(diff.min[i]<0){
diff.hour[i] <- diff.hour[i]-1
diff.min[i] <- diff.hour[i]+60
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}else{
diff.hour[i] <- diff.hour[i]
diff.min[i] <- diff.min[i]
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}
}else{
diff.min[i] <- diff.min[i]
diff.sec[i] <- diff.sec[i]
if(diff.min[i]<0){
diff.hour[i] <- diff.hour[i]-1
diff.min[i] <- diff.min[i]+60
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}else{
diff.hour[i] <- diff.hour[i]
diff.min[i] <- diff.min[i]
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}
}
}
diff.day
diff.hour
diff.min
diff.sec
index_repeated_block<-c()
for(i in 2:dim(dat)[1]){
if(dat$Height[i-1]!=dat$Height[i]|i==2){
index_repeated_block[i]<-i
}else{
index_repeated_block[i]<-0
}
}
index_repeated_block <- index_repeated_block[-which(index_repeated_block==0|is.na(index_repeated_block))]
date.dat <- data.frame(block = levels(as.factor(dat$Height)), date=dat$block_date[index_repeated_block], hour=tapply(dat$block_hour,dat$Height,mean), minute=tapply(dat$block_minute,dat$Height,mean), second=tapply(dat$block_second,dat$Height,mean))
diff.day<-c()
diff.hour<-c()
diff.min<-c()
diff.sec<-c()
for (i in 1:dim(date.dat)[1]-1){
diff.day[i] <- as.Date(date.dat$date[i+1], format="%m/%d/%Y")-as.Date(date.dat$date[i], format="%m/%d/%Y")
}
for (i in 1:dim(date.dat)[1]-1){
diff.hour[i] <- date.dat$hour[i+1]-date.dat$hour[i]
}
for (i in 1:dim(date.dat)[1]-1){
diff.min[i] <- date.dat$minute[i+1]-date.dat$minute[i]
}
for (i in 1:dim(date.dat)[1]-1){
diff.sec[i] <- date.dat$second[i+1]-date.dat$second[i]
}
for(i in 1:length(diff.day)){
if(diff.sec[i]<0){
diff.min[i] <- diff.min[i]-1
diff.sec[i] <- diff.sec[i]+60
if(diff.min[i]<0){
diff.hour[i] <- diff.hour[i]-1
diff.min[i] <- diff.min[i]+60
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}else{
diff.hour[i] <- diff.hour[i]
diff.min[i] <- diff.min[i]
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}
}else{
diff.min[i] <- diff.min[i]
diff.sec[i] <- diff.sec[i]
if(diff.min[i]<0){
diff.hour[i] <- diff.hour[i]-1
diff.min[i] <- diff.min[i]+60
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}else{
diff.hour[i] <- diff.hour[i]
diff.min[i] <- diff.min[i]
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24
}else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}
}
}
diff.day
diff.hour
diff.min
diff.sec
diff.day<-c()
diff.hour<-c()
diff.min<-c()
diff.sec<-c()
for (i in 1:dim(date.dat)[1]-1){
diff.day[i] <- as.Date(date.dat$date[i+1], format="%m/%d/%Y")-as.Date(date.dat$date[i], format="%m/%d/%Y")
}
for (i in 1:dim(date.dat)[1]-1){
diff.hour[i] <- date.dat$hour[i+1]-date.dat$hour[i]
}
for (i in 1:dim(date.dat)[1]-1){
diff.min[i] <- date.dat$minute[i+1]-date.dat$minute[i]
}
for (i in 1:dim(date.dat)[1]-1){
diff.sec[i] <- date.dat$second[i+1]-date.dat$second[i]
}
diff.sec
diff.min
diff.hour
for(i in 1:length(diff.day)){
if(diff.sec[i]<0){
diff.min[i] <- diff.min[i]-1
diff.sec[i] <- diff.sec[i]+60
if(diff.min[i]<0){
diff.hour[i] <- diff.hour[i]-1
diff.min[i] <- diff.min[i]+60
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24}
else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}}
else{
diff.hour[i] <- diff.hour[i]
diff.min[i] <- diff.min[i]
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24}
else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}}
else{
diff.min[i] <- diff.min[i]
diff.sec[i] <- diff.sec[i]
if(diff.min[i]<0){
diff.hour[i] <- diff.hour[i]-1
diff.min[i] <- diff.min[i]+60
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24}
else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}}
else{
diff.hour[i] <- diff.hour[i]
diff.min[i] <- diff.min[i]
if(diff.hour[i]<0){
diff.day[i] <- diff.day[i]-1
diff.hour[i] <- diff.hour[i]+24}
else{
diff.day[i] <- diff.day[i]
diff.hour[i] <- diff.hour[i]
}
}}
}
diff.day
diff.hour
diff.min
diff.sec
which(diff.day<0)
index.repeated_block(which(diff.day<0))
index.repeated_block[which(diff.day<0)]
index_repeated_block[which(diff.day<0)]
diff.hour[which(diff.day<0)]
diff.hour[which(diff.day<0)[1]]
diff.min[which(diff.day<0)][1]
diff.min[which(diff.day<0)][1]]
diff.min[which(diff.day<0))[1]]
diff.min[which(diff.day<0)[1]]
diff.sec[which(diff.day<0)[1]]
diff.hour[which(diff.day<0)[1]]
diff.min[which(diff.day<0)[1]]
diff.sec[which(diff.day<0)[1]]
diff.day
diff.day
diff.hour
diff.min
diff.sec
as.Date(date.dat$date[2], format="%m/%d/%Y")-as.Date(date.dat$date[3], format="%m/%d/%Y")
as.Date(date.dat$date[3], format="%m/%d/%Y")-as.Date(date.dat$date[2], format="%m/%d/%Y")
index_repeated_block[which(diff.day<0)]
which(diff.day<0)
levels(as.factor(dat$Height))which(diff.day<0)
levels(as.factor(dat$Height))[which(diff.day<0)]
which(diff.day<0)
levels(as.factor(dat$Height))[171]
cbind(diff.day,diff.hour,diff.min,diff.sec)
